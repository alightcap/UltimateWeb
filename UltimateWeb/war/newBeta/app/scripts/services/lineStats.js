// Generated by CoffeeScript 1.7.1
'use strict';
angular.module('newBetaApp').factory('lineStats', function($q, team, allGames, filter) {
  var api, deferred, getStats, includedGames;
  deferred = $q.defer();
  includedGames = null;
  $q.all([team, allGames]).then(function(response) {
    includedGames = filter.included;
    team = response[0];
    return deferred.resolve(api);
  });
  getStats = function(players) {
    var consideredPoints, result;
    result = {};
    consideredPoints = [];
    _(includedGames).each(function(game) {
      return _(game.points).each(function(point) {
        if (_(point.line).intersection(players).length === players.length) {
          return consideredPoints.push(point);
        }
      });
    });
    result.consideredPoints = consideredPoints;
    return result;
  };
  api = {
    getPlayers: function() {
      return _(team.players).pluck('name');
    },
    getStats: getStats
  };
  return deferred.promise;
});
